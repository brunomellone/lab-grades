---
title: "Mellone"
author: "Bruno Mellone"
format: html
---

Link to GitHub repository: https://github.com/brunomellone/lab-grades

```{r}
library(here)
library(dplyr)
library(ggplot2)
library(tidyr)
library(vroom)
library(readr)
here :: i_am("lab-grades.Rproj")
```
# 1.1 Study organization
Question 1
```{r}
courses <- vroom(here("data","courses.csv"))
```
Question 2
```{r}
courses |>
  arrange(course) |>
  rename(
    `course name`    = course,
    identifier       = course_id,
    module           = module,
    `number of exams` = nb_grades
  ) |>
  knitr::kable()
```


# 1.2 Students

Question 3
```{r}
students <- vroom(here("data","students.csv"))
cols(
  id = col_double(),
  group = col_double(),
  birth_date = col_date(format = ""),
  sex = col_character(),
  .delim = ","
)
```
```{r}
students <- vroom(
  here("data", "students.csv"),
  col_types = cols(
    id = col_double(),
    group = col_double(),
    birth_date = col_date(), 
    sex = col_factor()       
  )
)
```


# 1.3 Grades
Question 4

```{r}
grades <- read_delim(here("data", "grades.csv"),
  delim = ";",
  na = "unknown")
```

# 2. Student population analysis

Question 5

```{r}
students |>
  summarise(n = n(), .by = group) |>
  ggplot(aes(x = group, y = n)) +
  geom_col() +
  labs(x = "group", y = "number of students")
```

Question 6
```{r}
students |>
  summarise(n = n(), .by = c(group, sex)) |>
  ggplot(aes(x = group, y = n, fill = sex)) +
  geom_col(position = "fill") +
  labs(x = "group", y = "proportion of students", fill = "sex")

```

Question 7

```{r}
library(lubridate)

students_new <- students |>
  mutate(
    birth_date = date(birth_date),
    age = time_length(today() - birth_date, unit = "year") |> round()
    )

students_new |>
  ggplot(aes(x = age)) +
  geom_histogram(binwidth =1) +
  labs(x = "age (years)", y = "number of students")
```

```{r}
students_new |>
  summarise(median_age = median(age), .by = group) |>
  mutate(median_age = round(median_age))
```

```{r}
students_new |>
  slice_max(age, n = 1, by = group) |>
  select(id, sex, age) |>
  arrange(desc(age)) |>
  knitr::kable()
```



# 3. Simple grade analysis

Question 10
```{r}
grades |>
  filter(!is.na(grade)) |>
  summarise(n_grades = n())
```

The data set contains `grades$n_grades`

Question 11
```{r}
grades |>
  filter(!is.na(grade)) |>
  inner_join(courses, by = "course_id") |>
  filter(course == "Medicine and Healing Arts") |>
  inner_join(students, by = "id") |>
  summarise(mean_grade = mean(grade), .by = group) |>
  ggplot(aes(x = group, y = mean_grade)) +
  geom_col() +
  labs(x = "group", y = "average grade in Medicine and Healing Arts")
```
Question 12

```{r}
grades |>
  filter(!is.na(grade)) |>
  inner_join(courses, by = "course_id") |>
  ggplot(aes(x = grade)) +
  geom_histogram(binwidth = 1) +
  facet_wrap(~ module) +
  labs(x = "grade", y = "number of grades")
```

Question 14
The distribution of the grades in modules 1 and 2 seem to be normally distributed. Module 1's distribution is around the mean of 9 and module 2 has a higher mean of 12. 

However, the graph of module 3 can lead us to the conclusion that it was perhaps the easiest module as more than 3000 students had over 13 and grades were generally better, when compared to other models. 

We could therefore conclude that module 3 had a higher average grade. This could lead us to believe that it was either easier or that students studied harder for it. 




